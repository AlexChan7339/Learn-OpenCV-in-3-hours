# 9-脸部识别

对于人脸检测项目，我们需要收集大量正样本（能检测到人脸）和负样本（除人脸以外的任何图像），利用这些正样本和负样本，我们将进行训练，帮助我们识别人脸

<img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202511221444821.png" alt="image-20251112220229829" style="zoom:25%;" />

> OpenCV一共了可以检测不同事物的默认级联分类器，包括车牌、眼睛、全身、人脸等等
>
> <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202511221444886.png" alt="image-20251112220442470" style="zoom:25%;" />

```python
import cv2

faceCascade= cv2.CascadeClassifier("Resources/haarcascade_frontalface_default.xml")
img = cv2.imread('Resources/lena.png')
imgGray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)

faces = faceCascade.detectMultiScale(imgGray,1.1,4)

for (x,y,w,h) in faces:
    cv2.rectangle(img,(x,y),(x+w,y+h),(255,0,0),2)
    # 绘制目标框


cv2.imshow("Result", img)
cv2.waitKey(0)
```

- `faceCascade= cv2.CascadeClassifier("Resources/haarcascade_frontalface_default.xml")`

  - 加载预训练的 Haar 级联分类器模型文件，用于检测人脸。
  - `"Resources/haarcascade_frontalface_default.xml"`：预训练模型文件路径，该文件是 OpenCV 提供的 Haar 特征分类器，专门用于检测正面人脸（包含大量正面人脸的特征模板）。

- `faces = faceCascade.detectMultiScale(imgGray,1.1,4)`

  - **功能**：在灰度图中检测人脸，返回所有检测到的人脸区域的坐标和尺寸。

  - 参数

    - `1.1`：**尺度因子（scaleFactor）**，表示每次检测时图像尺寸缩小的比例（此处每次缩小 10%）。用于检测不同大小的人脸（大脸缩小后匹配模板，小脸放大后匹配）。

    - `4`：**最小邻域数（minNeighbors）**，表示每个候选矩形需要保留的相邻检测框数量（值越大，检测越严格，误检越少，但可能漏检）。

      > `minNeighbors` 表示**每个候选目标矩形需要保留的相邻检测框数量**。Haar 分类器通过 “滑动窗口” 遍历图像时，会在不同尺度、不同位置生成大量候选框（可能包含真正的目标和误检框）。只有当一个候选框周围有至少 `minNeighbors` 个重叠的候选框时，才会被判定为**有效目标**；否则视为误检，被过滤掉。